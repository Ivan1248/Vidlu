python run.py train

"MNIST{train,val}" "ResNet,backbone_f=t(depth=18,small_input=True)" ResNetCifarTrainer
"whitenoise{train,test}" "ResNet,backbone_f=t(depth=18,small_input=True),head_f=partial(vidlu.nn.components.classification_head,10)" ResNetCifarTrainer "accuracy"

"Cifar10{train,val}" "ResNet,backbone_f=t(depth=18,small_input=True)" ResNetCifarTrainer ""

"Cifar10{train,val}" "ResNet,backbone_f=t(depth=18,small_input=True),init=t(zero_init_residual=False)" ResNetCifarTrainer ""
"Cifar10{train,val}" "ResNet,backbone_f=t(depth=10,small_input=True,base_width=4)" ResNetCifarTrainer ""
"Cifar10{train,val}" "DiscriminativeModel,backbone_f=c.VGGBackbone,init=partial(init.kaiming_resnet)" ResNetCifarTrainer ""
"Cifar10{train,val}" "SmallImageClassifier" "SmallImageClassifierTrainer,data_loader_f=t(num_workers=4)" "" -v 2
"Cifar10{train,val}" "DiscriminativeModel,backbone_f=partial(c.PreactBlock,kernel_sizes=[3,3,3],base_width=64,width_factors=[1,1,1]),init=partial(init.kaiming_resnet)" ResNetCifarTrainer ""

python run.py train
-d "Cifar10-train,val" --input_prep "standardize(Cifar10-train,)" -m "ResNet,backbone_f=t(depth=18,small_input=True)" -t ResNetCifarTrainer --metrics ""

python run.py train "cifar10{train,val}" standardize "ResNetV2,backbone_f=t(depth=18,small_input=True)" "Trainer,**configs.resnet_cifar"
python run.py train "cifar10{train,val}" div255      "ResNetV2,backbone_f=t(depth=18,small_input=True)" "Trainer,**configs.resnet_cifar"

python run.py train "cifar10{train,val}" div255 "DenseNet,backbone_f=t(depth=121,small_input=True)" "Trainer,**configs.resnet_cifar"

# SwiftNet pretrained on Cityscapes
python run.py train "cityscapes{train,val}" standardize "SwiftNet,backbone_f=t(depth=18,small_input=False)" "Trainer,**{**configs.swiftnet,'epoch_count':40}" --params swiftnet,swiftnet_ss_cs.pt
python run.py train "cityscapes{train,val}" standardize "ClassificationModel,backbone_f=modules.other.swiftnet.resnet18,init=lambda *a,**k: None" "Trainer,**configs.swiftnet" --params swiftnet_orig,swiftnet_ss_cs.pt

# Adversarial training
"cifar10{train,val}"     div255 "ResNetV2,backbone_f=t(depth=18,small_input=True)" "AdversarialTrainer,**{**configs.resnet_cifar,**configs.adversarial,'attack_f':partial(configs.madry_cifar10_attack, step_count=10)}"
"cifar10{trainval,test}" div255 "ResNetV2,backbone_f=t(depth=18,small_input=True)" "AdversarialTrainer,**{**configs.resnet_cifar,**configs.adversarial,'attack_f':partial(configs.madry_cifar10_attack, step_count=10)}"
python run.py train "cifar10{trainval,test}" div255 "ResNet,backbone_f=t(depth=18,small_input=True)" "AdversarialTrainer,**{**configs.resnet_cifar,**configs.adversarial,'train_step':configs.AdversarialTrainStep(True),'attack_f':partial(configs.madry_cifar10_attack, step_count=10,stop_on_success=True)}"
## Swiftnet
python run.py train "cityscapes{train,val}" standardize "SwiftNet,backbone_f=t(depth=18,small_input=False)" "AdversarialTrainer,**{**configs.swiftnet,'epoch_count':40, 'batch_size':1, **configs.adversarial,'train_step':configs.AdversarialTrainStep(False),'attack_f':partial(configs.madry_cifar10_attack, step_count=40, eps=48/255, clip_bounds=None, )}" --params swiftnet,swiftnet_ss_cs.pt


